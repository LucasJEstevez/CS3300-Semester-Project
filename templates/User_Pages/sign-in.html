{% extends "base.html" %}

{% block title %}Sign-In{% endblock %}

{% block content %}
<script>
  function login(){
    // Get login information from text boxes
    var username = document.getElementById("username").value;
    var password = document.getElementById("password").value;
  
    // Check if username is empty
    if (username == '') {
        document.getElementById("usererror_display").innerHTML = "Error: Username cannot be empty";
    }

    // Check if password is empty
    else if (password == '') {
        document.getElementById("usererror_display").innerHTML = "Error: Password cannot be empty";
    }

    else {

      // Creates data to send to server
      var formData = {
          username: username,
          password: password
      };

      // Use fetch to send data via POST to the correct Flask endpoint
      fetch('http://localhost:5000/login', {  // Route to Flask, will need to change
          method: 'POST',
          headers: {'Content-Type': 'application/json' },
          body: JSON.stringify(formData)
      })

      // Get and handle response from server
      .then(response => response.json())
      .then(data => {
          console.log(data);
          if (data.message === 'Login successful!') {
              document.getElementById("usererror_display").innerHTML = "good login, change this";
          } else {
              document.getElementById("usererror_display").innerHTML = data.message;
          }
      })

      //Error handling
      .catch(error => {
          console.error('Error during form submission:', error);
          
          document.getElementById("usererror_display").innerHTML = 'Request failed: ' + error.message;
      });
    }
  }
</script>
</body>
</html>

{% endblock %}